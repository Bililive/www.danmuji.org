---
hide: false
title: 点歌姬
auther: 宅急送队长
plugin_author: 宅急送队长
plugin_name: 点歌姬 (v3)
plugin_desc: 用弹幕来播放歌曲吧
plugin_version: 3.0.0.0
plugin_update_datetime: 2018-08-31 19:00:00 +0800
#plugin_update_desc: |-
#  扒拉扒拉扒拉测试
#  测试，测试测试。
#  换行。
plugin_dllink: /resource/DGJv3/DGJv3.7z
#plugin_dlnote: 看这个页面右侧的使用说明！
---

点歌姬 v3 和 v2 会互相冲突导致崩溃，请保证插件文件夹里**只有一个版本**的点歌姬插件。  
点歌姬 v3 只支持 64 位系统。点歌姬v2 里有的一部分功能 点歌姬v3 还没有做，如有使用需求可以暂时继续使用 [点歌姬v2(点我下载)](/plugins/DGJ)

---

## 安装插件

将压缩包中的 `DGJv3.dll` 解压放到 `文档\弹幕姬\Plugins` 文件夹，插件文件夹可以在弹幕姬的插件一页用快速打开按钮打开。

安装后，打开弹幕姬，在插件一页右键点歌姬，点击 “管理” 可以打开点歌姬界面。第一次使用，在点歌之前需要选择使用什么歌曲平台搜索。

![install](/resource/DGJv3/install.png)

## 弹幕命令

### 普通命令

- `点歌 搜索关键词` 搜索歌曲
  - 或 `點歌 關鍵詞`
- `取消点歌` 取消自己的最后一首还没有开始播放的歌曲
  - 或 `取消點歌`

### 房管命令

- `切歌` 删除列表中的第一首歌曲
- `暂停` 暂停播放
  - 或 `暫停`
- `播放` 继续播放
- `音量 数字` 设置音量

## 输出文本

在 `文档\弹幕姬\Plugins\点歌姬v3` 文件夹里有 `信息.txt` 和 `歌词.txt` 两个文件，可以使用直播软件读取，显示在直播画面上。

![output](/resource/DGJv3/output.png)

<br/>

OBS Studio 添加来源方法：

1. 在 “来源” 中右键，添加一个 `文本 (GDI+)` 来源
2. 给来源设置一个容易区分的名字
3. 勾选 “从文件读取”
4. 点击 “浏览” 按钮，选择一个 txt 文件
5. 调整颜色、字体、样式到想要的样子

哔哩哔哩直播姬添加来源方法：

1. 点击左下角的 “文本”
2. 给来源设置一个容易区分的名字
3. 勾选 “从文件读” 
4. 点击 “浏览” 按钮，选择一个 txt 文件
5. 调整颜色、字体、样式到想要的样子

OBS Classic 添加来源方法：

1. 在 “来源” 中右键，选择 “添加”、“文字来源”
2. 随便填写一个容易区分的来源名字，确认
3. 勾选 “使用文件中的文字”
4. 点击 “浏览” 按钮，选择一个 txt 文件
5. 调整颜色、字体、样式到想要的样子

## 输出文本模板

点歌姬v2 使用的是简单的文本替换，而 点歌姬v3 使用了文本模板引擎，功能更强大、可以运行简单的脚本，但使用方法也相对较复杂。

有能力的主播可以自行翻阅文本模板引擎的文档： [语法](https://github.com/lunet-io/scriban/blob/master/doc/language.md) [内置函数](https://github.com/lunet-io/scriban/blob/master/doc/builtins.md)（英语）

{% raw %}
简单说明：  
在 `{{` 和 `}}` 中间的内容是变量，会被替换成实际的文字，比如 `{{ 当前播放时间 }}` 会被替换成像 `01:34` 一样的时间。

默认示例：

```txt
播放进度 {{ 当前播放时间 }}/{{ 当前总时间 }}
当前列表中有 {{ 歌曲数量 }} 首歌
还可以再点 {{ 总共最大点歌数量 - 歌曲数量 }} 首歌
每个人可以点 {{ 单人最大点歌数量 }} 首歌

歌名 - 点歌人 - 歌手 - 歌曲平台
{{~ for 歌曲 in 播放列表 ~}}
{{ 歌曲.歌名 }} - {{  歌曲.点歌人 }} - {{ 歌曲.歌手 }} - {{ 歌曲.搜索模块 }}
{{~ end ~}}
```

只显示列表中前 3 首歌示例：

```txt
{{~ 最多显示歌曲数量 = 3 # <=- 修改这里的数字就是修改显示数量 ~}}
播放进度 {{ 当前播放时间 }}/{{ 当前总时间 }}
当前列表中有 {{ 歌曲数量 }} 首歌
还可以再点 {{ 总共最大点歌数量 - 歌曲数量 }} 首歌
每个人可以点 {{ 单人最大点歌数量 }} 首歌

歌名 - 点歌人 - 歌手 - 歌曲平台
{{~ for 歌曲 in 播放列表 ~}}
{{ 歌曲.歌名 }} - {{ 歌曲.点歌人 }} - {{ 歌曲.歌手 }} - {{ 歌曲.搜索模块 }}
{{~
    if for.index + 1 >= 最多显示歌曲数量 
      break
    end
  end
~}}
```
